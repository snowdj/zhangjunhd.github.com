---
layout: post
title: "读书笔记-统计学"
description: "统计学"
category: 数学
tags: [统计学,回归分析,方差分析,估计,检验,多元分析]
---
{% include JB/setup %}

读[《统计学》](http://book.douban.com/subject/1230154/)。

![zen](http://img5.douban.com/lpic/s26011980.jpg)

##1 统计学：随机性和规律性

1. `统计学`(statistics)是用以(1)收集数据、(2)分析数据和(3)由数据得出结论的一组概念、原则和方法。
2. `概率`(probability)是一个取值于0和1之间的数，告诉我们某一特定的事件以多大的机会发生。
3. `变量`(variable)是指一个可以取两个或更多个可能值的特征、特质或属性。
4. 变量的`值`(value)通常是对某一特定单元的度量，这种单元常常被视为一个`个体`(element)。

##2 数据的收集

1. `总体`(population)包含所有需要研究的个体。
2. `普查`(census)是指基于收集整个总体的数据的过程。
3. `样本`(sample)是总体的一个被选中的部分。
4. `随机样本`(random sample)指来自于总体的这样一个样本，即总体的每个个体有一个已知的(有时是相等的)机会被包含在该样本中。
5. 主要的统计误差即所谓的`抽样误差`(sampling error)。这并不是某件事出错造成的误差，而是指这样的一个事实：如果研究被再做一遍，结果未必会和上一次一模一样。抽样误差的大小依赖于得到样本的方式和样本中包含的观测的个数。样本越大，误差越小。如果样本等于整个总体，则样本比例就等于总体比例。在总体变化以前，对整个总体做重复研究，就会得到相同的结果。在这种情况下，抽样误差是0。
6. `未响应误差`(nonresponse error)是指，由于包含在样本中的一部分人未回应调查而造成的误差。
7. `响应误差`(response error)是指在调查过程中，由于问题的提问方式、问题所处的位置或访员的影响而使响应者在回答问题时产生的误差。
8. 实验数据
    * `实验数据`(experimental group)是指在实验中控制试验对象而收集到的变量的数据。
    * `对照组`(control group)是指试验对象中一个被随机选择的子集，其中的个体没有特殊待遇。

##3 数据的描述：图和表

1. `分类变量`(category variable)是指它的任何两个观测值或者相同，或者不同。观测值不能够被排序，一个观测值并不比另一个观测值多什么。
    * 为一个分类变量作图:观察在Massachusetts州 New Bedford 地方法庭判决的72名犯人的数据。在他们服完刑一年到两年半时间里，他们是否又因新的罪行被判决(24人犯了新罪)：![1](/assets/2014-01-27-statistics/1.png)
    * 为两个分类变量作图：继续讨论这72名犯人，现在让他们选择进监狱或听文学课。调查发现选择听课的32人，发现以后其中的6人犯了新罪；而选择去监狱的40人中，18人在被释放后犯了新罪：![2](/assets/2014-01-27-statistics/2.png)

2. `度量变量`(metric variable)是这样的变量，我们可根据它确定一个观测值是否和另外一个不同。我们还可以确定一个观测值比另外一个观测值多(还是少)多少。
    * 为一个度量变量作图:根据一家地方报纸列出的一个星期之内申请结婚的女性的年龄(37个值):
        
            30 27 56 40 30 26 31 24 23 25 29 33 29 22 33 29 46 25
            34 19 23 23 44 29 30 25 23 60 25 27 37 24 22 27 31 24 26
        ![3](/assets/2014-01-27-statistics/3.png)
        
        * 在`盒形图`(boxplot)中，从线的最小值到盒子的开始包含了1/4的观测(37/4=9)，从盒子的开始(刻度为24)到盒子中间(刻度为27)的线包含了1/4的观测，从这条线到盒子结束(刻度为32)包含了1/4观测，从盒子结束到线的结束(刻度为60)则包含了剩余的1/4的观测。因此，恰有一半的数据位于盒子所在的区域。
        * `茎叶图`(stemplot)。左边的枝叶代表年龄的第一位数字，右边的枝叶代表年龄的第二位数字，处于该年龄的新娘有几个则列出几位。为清楚起见，每10年被分成了两部分；例如，2代表年龄20-24岁，2+代表年龄25-29。
    * 为两个度量变量作图：下图是37对新婚夫妇年龄数据的散点图：![4](/assets/2014-01-27-statistics/4.png)

##4 数据的描述：计算汇总统计量

1. 一个变量的`众数`(mode)就是指出现次数最多的数的值。
2. 一个变量的`中位数`(median)是这样一个数字，它把观测值分成同等数目的两组数，一半观察值小于等于这个数，而另一半大于等于这个数。
3. `均值`(mean)是所有观察值相加的和除以观察值的个数。
4. `极差`(range)是变量观察值中最大值和最小值的差。当最小的25%的数据与最大的25%的数据都被去掉后，极差是所剩中间部分的观察值的极差，即所谓的`四分位极差`(interquartile range)。无论是全级差还是四分位极差都可以用盒式图表示出来。
5. `标准差`(standard deviation)是到`均值`的一种平均距离。
    * 标准差s可以由先计算观察值与均值的差，然后将这个数字平方后求和，最后再取平均值获得。注意这里图中有7个值，但是我们用6除得到平方的平均值：![5](/assets/2014-01-27-statistics/5.png)
    * 对于大部分单峰对称分布，我们可以通过均值和标准差来还原它的分布：均值加减一个标准差的值包含了所有观测值的2/3，均值加减两个标准差的值则包含了几乎所有的观测值：![6](/assets/2014-01-27-statistics/6.png)
6. `方差`(variance)是标准差的平方。
7. `标准误差`(standard error)是很多不同样本的均值的标准差。
8. `标准得分`(standard scores)表示原始数据和均值的距离的新衡量(按标准差单位)。
9. 公式。x表示变量，这个变量的n个观察值表示为`\(x_1,x_2,...,x_n\)`，排序后的观察值为`\(x_{(1)},x_{(2)},...,x_{(n)}\)`
    * 中位数 = `\(\begin{cases} 
\frac{x_{(n/2)}+x_{(n/2+1)}}{2},  & \mbox{if }n\mbox{ is even} \\
\frac{x_{(n+1)}}{2}, & \mbox{if }n\mbox{ is odd}
\end{cases}\)`
    * 均值 `\(\bar{x}=\frac{x_1+x_2+...+x_n}{n}=\frac{\sum{x}}{n}\)`
    * 方差 `\(s^2=\frac{\sum{(x-\bar{x})^2}}{n-1}\)`
    * 标准差 `\(s=\sqrt{s^2}\)`
    * 均值的标准误差 `\(s_{\bar{x}}=\frac{s}{\sqrt{n}}\)`
    * 标准得分 = `\(\frac{x-\bar{x}}{s}\)`

##6 作出结论：估计

1. 样本统计量和总体参数
    * 最平常的`样本统计量`(sample statistic)的例子是样本的均值`\(\bar{x}\)`、样本百分比P和样本标准差s。
    * 在总体中，性质类似的量被称为`总体参数`(population parameter)。一般用希腊字母来标记。例如：总体均值用`\(\mu\)`标记、总体百分比用大写`\(\Pi\)`以及总体标准差用小写的`\(\delta\)`。

![7](/assets/2014-01-27-statistics/7.png)

2. 点估计
    * `点估计`(point estimation)是一个用来估计总体参数的数。一个好的点估计的标准：
        * 如果大量样本的样本统计量的均值等于总体参数的真值，则这种样本统计量是该参数的`无偏估计`。
        * 许多重复抽样所得的估计量不应偏离真值太远。
3. 区间估计
    * `区间估计`(interval estimate)又称`置信区间`(confidence interval)，是用来估计参数的取值范围的。一个总体参数的置信区间是用一个样本统计量加、减样本误差得到的：统计量-样本误差~统计量+样本误差。
    * 如果我们收集了许多不同的样本，并对每个样本都构造了一个置信区间。这些置信区间有足够的宽度使它们中的95%包含了总体百分点的真值，而5%没包含。则95%这个值就被称为`置信水平`(confidence level)。它真正的意义是如果你做了100次抽样，大概有95次找到的区间包含真值，有5次找到的区间不包含真值。
    * 样本中的观测值个数影响着置信区间的长度。大的样本产生较短的置信区间，小的样本产生较长的置信区间。
    * 置信区间的长度还受置信水平的影响。低的置信水平(如90%)产生较短的区间，高的置信水平(如99%)产生较长的区间。

4. 公式
    * 总体百分数的置信区间：从一个大的总体中抽取一个由n个观测值组成的随机样本，用P来标记样本百分比。我们想要得到总体百分比`\(\Pi\)`的一个95%置信区间。该区间为`\(P-1.96\sqrt{\frac{P(100-P)}{n}}\)`到`\(P+1.96\sqrt{\frac{P(100-P)}{n}}\)`(6.1)
        * 1.96这个值来自正态分布(可以从正态分布表中查到)，是变量z的一个值。它使得2.5%的z值小于-1.96同时2.5%的z值大于1.96.也就是说95%的z值落在-1。96到1.96之间，从而构成了95%的置信区间。
        * 一个快速计算95%置信区间的近似方法是令P=50，同时四舍五入1.96到2：`\(P-\frac{100}{n}\)`到`\(P+\frac{100}{n}\)`(6.2)
        * 在某种意义上，这是一个保守的置信区间，因为大多数情况下它比公式6.1得到的区间要稍长一些。由公式6.2可知，对于一个有900个观测样本，误差是100/30=3.3，而对有1600个观测的样本这个误差变成了2.5。
    * 总体均值的置信区间：由n个独立的、服从正态分布的观测组成一个样本，样本均值计为`\(\bar{x}\)`，样本标准差记为s。则总体均值的置信区间是：`\(\bar{x}-t^*\frac{s}{\sqrt{n}}\)`到`\(\bar{x}+t^*\frac{s}{\sqrt{n}}\)`，d.f.=n-1 (6.3)。
        * 这儿`\(t^*\)`是t变量的一个值，它可以从自由度为n-1的t分布的统计表查到。
        * 在少数情况下总体的标准差`\(\delta\)`是已知的，这时可以用`\(\delta\)`去代替公式中的样本标准差s，同时还可以用来自正态分布的值`\(z^*\)`去代替来自t分布的`\(t^*\)`。这时置信区间就变成了：`\(\bar{x}-z^*\frac{\delta}{\sqrt{n}}\)`到`\(\bar{x}+z^*\frac{\delta}{\sqrt{n}}\)`，当`\(z^*\)`=1.96时它是一个95%置信区间。
    * 两个百分比之差的置信区间：一个样本有`\(n_1\)`个观测，另一个有`\(n_2\)`个观测；相应地，两个样本的样本百分比分别为`\(P_1\)`和`\(P_2\)`。则两个总体百分比`\(\Pi_1\)`和`\(\Pi_2\)`之差的95%置信区间是：`\((P_1-P_2)-1.96\sqrt{\frac{P_1(100-P_1)}{n_1}+\frac{P_2(100-P_2)}{n_2}}\)`到`\((P_1-P_2)+1.96\sqrt{\frac{P_1(100-P_1)}{n_1}+\frac{P_2(100-P_2)}{n_2}}\)`(6.4)
    * 两个均值之差的置信区间：一个含有`\(n_1\)`个观测的样本的样本均值为`\(\bar{x_1}\)`，样本标准差为`\(s_1\)`。另一个样本有`\(n_2\)`个观测的样本的样本均值为`\(\bar{x_2}\)`，样本标准差为`\(s_2\)`。先由公式：`\(s=\sqrt{\frac{(n_1-1)s_1^2+(n_2-1)s_2^2}{n_1+n_2-2}}\)`给出两个标准差的平均值，然后就可以得到两个总体均值`\(\mu_1\)`与`\(\mu_2\)`之差的置信区间了：`\((\bar{x_1}-\bar{x_2})-t^*s\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}\)`到`\((\bar{x_1}-\bar{x_2})+t^*s\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}\)`(6.5)
        * 我们从自由度是`\(n_1+n_2-2\)`的t分布表中查的到`\(t^*\)`的值，使t变量落入`\(-t^*\)`到`\(t^*\)`之间的概率是0.95。

##7 作出结论：假设检验

1. `估计`的主要任务是找参数值等于几；`假设检验`的兴趣主要是看参数的值是否等于某个特别感兴趣的值。
2. 一个统计上的`零假设`(null hypothesis)提出一个参数是否等于某个特殊值的问题，形式上零假设则被写成:`\(H_0:参数=值\)`。
    * 而它的反面假设称为`备择假设`(alternative hypothesis)。当零假设所提问题的答案被否定时，备择假设的答案就是肯定的。
    * `第一类错误\(\alpha错误\)`(type I error)：在假设检验中拒绝了本来正确的零假设。
    * `第二类错误\(\beta错误\)`(type II error)：在假设检验中没有拒绝本来是错误的零假设。
3. `p-值`(p-value)是当零假设正确时，得到所观测的数据或更极端的数据的概率。
    * 当p-值如此之小，以至于几乎不可能在零假设正确时出现目前的观测数据时，我们就拒绝零假设。p-值越小，拒绝零假设的理由就越充分。
    * 著名的英国统计家Ronald Fisher把0.05作为标准，从此0。05或者比0.05小的概率都被认为是小的。
    * 如果零假设被拒绝，就可以说样本结果(经验结果)是`统计显著`的。换句话说，如果p-值很小，经验结果就是统计显著的。
4. 一个检验的`显著水平\(\alpha\)`(signaficant level)是抽样所得的数据拒绝了本来正确的零假设的概率。
    * 显著水平是0.05的意思是：在零假设正确的情况下进行100次抽样，会有5次错误地拒绝了零假设。
    * 对于双边检验，样本统计量的`临界值`(critical values)是两个值。当假设正确时，来自不同样本的样本统计量中只有5%的值超越了这两个值之一。下图7.4是显著水平是0.05的关于两样本均值差异的假设检验。-0.6和+0.6是临界值。下图7.5比较了双边和单边假设检验。

![8](/assets/2014-01-27-statistics/8.png)

![9](/assets/2014-01-27-statistics/9.png)

5. 公式
    * 单个均值的检验：它的零假设要问的是“总体均值`\(\mu\)`是否等于一个特殊数值`\(\mu_0\)`”：`\(H_0:\mu=\mu_0\)`
        * 一个样本包含n个观测，均值是`\(\bar{x}\)`，标准差是s。为检验零假设先要把样本均值做一个变换，变成t变量的一个值，公式为：`\(t=\frac{\bar{x}-\mu_0}{s/\sqrt{n}}\)`(7.1)
        * 用t的这个观测值，通过统计表可以计算出相应的p-值。如果p-值很小就拒绝零假设。
        * 考虑零假设`\(H_0:\mu=4.0\)`。如果样本容量n=12，均值`\(\bar{x}\)`=2.0，标准差s=1.54，则有`\(t=\frac{2.0-4.0}{1.54/\sqrt{12}}\)`=-4.50，d.f.=12-1=11
        * t≤-4.50的概率是0.0005，即p-值是0.0005.如果用5%的显著水平或t分布表来判断，对于自由度是11的t分布来说t<-2.20或t>2.20的概率是5%。现在t的值为更极端的-4.50，所以拒绝零假设。
    * 检验两均值的不同：设两个总体的均值分别是`\(\mu_1\)`和`\(\mu_2\)`，零假设是：两个均值相等：`\(H_0:\mu_1-\mu_2=0\)`
        * 为检验零假设，从两个总体中抽取样本数据，第一个样本有`\(n_1\)`个观测，均值是`\(\bar{y_1}\)`，标准差是`\(s_1\)`；第二个样本有`\(n_2\)`个观测，均值是`\(\bar{y_2}\)`，标准差是`\(s_2\)`。通过这些可以计算出下面的t统计量：`\(t=\frac{\bar{y_1}-\bar{y_2}}{s\sqrt{1/n_1+1/n_2}}\)`,d.f.=`\(n_1+n_2-2\)`(7.2)
        * 如果计算出的t值超过了从t分布表中查到的临界值，就拒绝零假设。
        * 要计算t，我们首先要计算标准差s。它可以通过被称为来自两个样本的联合方差计算得到：`\(s^2=\frac{(n_1-1)s_1^2+(n_2-1)s_2^2}{n_1+n_2-2}\)`(7.3)。使用这个公式的前提是样本所属的两个总体的方差相等。
        * 在总体方差相等的情况下，有一个计算t值的简化公式：`\(t=\frac{\bar{y_1}-\bar{y_2}}{\sqrt{s_2^2/n_1+s_1^2/n_2}}\)`,d.f.=`\(n_1+n_2-2\)`(7.4)
    * 总体比例检验：零假设为总体比例`\(\pi\)`等于一个特殊值`\(\pi_0\)`:`\(H_0:\pi=\pi_0\)`
        * 我们把样本比例p的值变换成z变量的一个值，公式如下：`\(z=\frac{p-\pi_0}{\sqrt{\frac{\pi_0(1-\pi_0)}{n}}}\)`(7.4)，此处n是样本尺寸。
        * 作为一个例子，假设n=1000个观测的样本的样本比例是p=0.60.我们想检验零假设`\(H_0:\pi=0.50\)`
        * 首先把p-值变换成z值`\(z=\frac{0.60-0.50}{\sqrt{\frac{0.50(1-0.50)}{1000}}}=6.32\)`
        * 而z≥6.32的概率<0.0001。这样，在总体比例是0.05的情况下，含有1000个观测的样本之比例≥0.60的概率是如此之小，于是我们只好拒绝零假设，并下结论说样本不可能来自这样的总体，真正的总体比例应大于0.50。
    * 比例之差的检验：零假设为两个总体比例相等：`\(H_0:\pi_1-\pi_2=0\)`
        * 为了对零假设进行检验，我们把两个样本的观察比例之差`\(\pi_1-\pi_2\)`用下面公式变换成为z:`\(z=\frac{(p_1-p_2)-(\pi_1-\pi_2)}{\sqrt{\frac{p_1(1-p_1)}{n_1}+\frac{p_2(1-p_2)}{n_2}}}\)`(7.5)，其中`\(n_1\)`和`\(n_2\)`分别是两个样本中观测的个数。
        * 在罪犯的那个例子中一个样本中的32个人中有6个被判犯新罪，而另一个样本的40个人中有18个被判犯新罪。这就给出了`\(p_1\)`=6/32=0.19，`\(p_2\)`=18/40=0.45。有`\(z=\frac{(0.45-0.19)-0}{\sqrt{\frac{0.45(1-0.45)}{40}+\frac{0.19(1-0.19)}{32}}}=2.35\)`
        * 而z=2.35的p-值是0.0094，因此我们拒绝两个总体比例相等的零假设。
        * 这个方法也可以作少许变动。当零假设为真而且两个总体比例确实相等时，两个样本就可以联合在一起估计这个公共的值。重新犯罪的总人数所占的比例为p=(6+8)/(32+40)=0.33
        * 现在可以用这个公共的p-值来代替两个分别的值去计算z值：`\(z=\frac{(0.45-0.19)-0}{\sqrt{\frac{0.33(1-0.33)}{40}+\frac{0.33(1-0.33)}{32}}}=2.33\)`，其p-值为0.0099，得到同样的结论：拒绝两个总体比例相等的零假设。

##8 变量间的关系
1. 两个变量的4个问题
    * 问题1.从数据看来两个变量之间有关系吗？
    * 问题2.如果有，有多强？
    * 问题3.总体中是否有和样本中一样的关系？
    * 问题4.观测到的这个关系是因果关系吗？
    * 要回答问题1，就先要寻找样本数据中的关系模式。如果样本中确有关系，我们再来回答问题2.在回答问题2时我们需要计算一个系数来测量这个关系的强度。系数接近1表示关系强，而系数接近0表示关系弱。回答问题3时，我们应先建立一个“两个变量之间没有关系”的零假设，看能否拒绝该假设。我们计算观测数据的p值，如果p值很小就拒绝零假设。要回答问题4往往很困难。没有因果关系的两个变量之间也会有非常强的统计关系。试验型数据往往比观测型数据更容易确定是否有因果关系，因为在试验中可以控制其它的变量对结果的影响。
2. 自变量和因变量。我们把先发生的变量叫做`自变量`(independent variable)，而受其影响的那个变量称为`因变量`(dependent variable)。
3. 不同类型的变量
    * `分类型变量`(categorical)：它的值是非数量的范畴，例如性别变量。
    * `顺序型变量`(rank)：它的值是有序的。
    * `数量型变量`(metric)：它的值是可以作数字计算的有意义的数值，如收入。
4. 关于因果关系的问题
    * 用常识来判断这种关系是否在我们所知道的世界上有意义
    * 注意自变量是否发生在因变量之前
    * 如果可能，适当更改自变量，并观察因变量的值是否受到影响
    * 即使自变量是决定因变量的一个原因，也要认识到其它没被考虑进计划的其它重要变量可能影响因变量。

##9 两个分类变量的`\(\chi^2\)`分析
1. `列联表`(contingency table)是一个描述两个分类变量分布的频度表。水平安排自变量和垂直安排因变量是构造列联表的常用方法。![10](/assets/2014-01-27-statistics/10.png)
2. 问题1.变量间的关系？国籍和对人态度之间是否存在着一定的关系？
    * 判定两个变量是否相关的一个常用方法是将频率变为百分比，然后比较这些百分比。比较64%和21%要比比较625/985和206/969容易的多。![11](/assets/2014-01-27-statistics/11.png)
3. 问题2.关系的强度？由一个用数据计算出来的系数来度量。这个系数在0到1之间取值。一个接近于0的系数表示关系较弱，而系数若接近于1则表明关系很强。
    * 对于一个两行和两列的列联表，一个常用的表示关系强度的系数称作`\(\phi\)`。对于多于两行和(或)两列的表常用的系数是V。
4. 问题3.总体中的关系？要了解产生样本的总体的变量间是否存在一种关系，我们通过统计假设检验利用对样本的知识来推广到总体。
    * 第一步，提出零假设，即认为总体的两个变量不相关。是否拒绝零假设依赖于两个因素：(1)样本的关系有多强(`\(\phi\)`或V)，和(2)样本有多少个观察值(n)。如果样本很大，即使`\(\phi\)`或V很小也足以拒绝零假设。如果样本只有少数几个观测，则需要`\(\phi\)`或V很大才能拒绝零假设。
    * 要对于一个特定的样本计算p-值，需要将`\(\phi\)`或V变换为一个`\(\chi^2\)`变量的值。
    * 要计算与`\(\chi^2\)`变量相应的p-值，需要知道列联表的自由度。自由度df=(行数-1)x(列数-1)。
5. 问题4.是因果关系吗？对于只有两个变量的观测数据，不可能回答两变量间的关系是否为因果关系。统计的关系并不能说明是因果关系。
6. 公式
    * 计算强度`\(\phi\)`
        * `\(\phi=\frac{ad-bc}{\sqrt{(a+b)(c+d)(a+c)(b+d)}}\)`(9.1),假设列联表为![12](/assets/2014-01-27-statistics/12.png)
    * Cramer的V
        * `\(V=\sqrt{\frac{\chi^2}{n(L-1)}}\)`(9.2),其中n是观测的个数，L是行数和列数中较小的那个数。
    * `\(\chi^2\)`变量
        * 2 x 2表：对于一个两行和两列的列联表，可由下面的公式计算`\(\chi^2\)`：`\(\chi^2=n\phi^2=\frac{n(ad-bc)^2}{(a+b)(c+d)(a+c)(b+d)}\)`
        * 更大的表：基于所谓的期望频率来计算`\(\chi^2\)`，`\(期望频率=\frac{行总和x列总和}{表的总和}\)`
            * 对于表9.1中数据，我们得到如表9.8所示的期望频率。![13](/assets/2014-01-27-statistics/13.png)
            * 下一步可以通过比较观测频率和期望频率的差异来计算`\(\chi^2\)`，`\(\chi^2=\frac{观测频率-期望频率}{期望频率}=\frac{(625-418.9)^2}{418.9}+\frac{(206-412.1)^2}{412.1}+\frac{(360-566.1)^2}{566.1}+\frac{(763-556.9)^2}{556.9}\)`=335.1,d.f.=1 (9.4)

##10 两个数值型变量的回归分析和相关分析
1. `回归分析`(regression analysis)描述的是一个或多个自变量的变化是如何影响因变量的一种方法。`相关分析`(correlation analysis)描述的是两个数值变量间关系的强度。研究两个变量的回归分析称为`简单回归分析`(simple regression analysis)，这里“简单”是表示两个变量而不是多个变量。
2. 问题1.两个变量间的关系？
    * `散点图`(scatterplot)是以横轴为自变量，纵轴为因变量的一个图。图上每一个点代表一对观测值。
        * 表10.1点心食物中的热量和脂肪：![14](/assets/2014-01-27-statistics/14.png)
        * 表10.1数据的散点图(图10.1)：![15](/assets/2014-01-27-statistics/15.png)
3. 问题2a.关系的强度？
    * 当这些数据沿一条直线排列时，我们可以计算一个系数来衡量两个变量间的关系。对于两个数值变量，计算出来的系数记作r，简称其为`相关系数`(correlation coefficient)。也可称为`线性相关系数`(linear correlation coefficient)，`Pearson相关系数`(Pearson's correlation coefficient)或者`乘积相关系数`(product-moment correlation coefficient)
4. 问题2b.关系的形式？
    * 回归直线的方程称为`回归方程`(regression equation)。一条回归直线的方程可以写作：因变量 = 截距 + 斜率 x 自变量，用符号表示：y = a + bx。其中自变量的斜率称为`回归系数`(regression coefficient)。
    * 计算回归直线：最小二乘原理。所作的这条直线使这些直线的距离的平方和最小。从`最小二乘`(least squares)的意义上说，这条直线就是距离所有的点最近的那条直线，而且在这个意义上，它比任何其他直线都更好地代表了这些数据。
    * 把自变量的值代入回归直线的方程就得到了因变量的`预测值`(predicted value)。图10.1的回归方程可写为：`\(\hat{热量}=36.1+15.3脂肪含量\)`，用符号表示：`\(\hat{y}=36.1+15.3x\)`
    * `残差变量`(residual variable)包含了除自变量外其他所有变量对因变量的效应。
    * `总平方和`(total sum of squares)度量了自变量和残差变量在因变量上的效应，它等于`\((观测-平均)^2之和\)`。
    * 残差变量的效应是由一个观测点到回归直线的垂直距离，它们的和称作`残差平方和`(residual sum of squares)，有时也称为误差平方和。
    * 基于表10.1数据计算，由于自变量和残差变量的组合效应等于159060，而残差变量的效应为27182，自变量的效应则为159060-27182=131878。这个平方和也称作`回归平方和`(regression sum of squares)。
    * 基于表10.1数据计算数据的平方和及比例，而相关系数`\(r^2=0.91^2=0.83\)`，恰好是表10.4中由脂肪效应贡献的比例。：![16](/assets/2014-01-27-statistics/16.png)
5. 问题3.总体中的关系？
    * 置信区间的方法：样本回归系数是15.3卡/克。我们计算的样本误差为4.0。从而总体的斜率`\(\beta\)`的置信区间为15.3-4.0=11.3卡/克到15.3+4.0=19.3卡/克。我们希望，区间[11.3,19.3]很可能是所有95%地包含总体的回归系数`\(\beta\)`的区间中的一个，而不是那些很少的不包含`\(\beta\)`的区间中的一个。公式10.7说明怎样计算置信区间。
    * 用t进行假设检验：零假设：认为两变量间没有关系。为了检验零假设，我们可以用观测的样本回归系数b，也可以用观测的样本相关系数r。它们都得到相同的t统计量值。从得到的t统计量的值，我们可以计算p-值并对零假设下结论。这里，b=15.3卡/克，这个b值相应于t=8.24，(df=n-2=14)(公式10.8)。类似地，r=0.91，也得到相应的t=8.24(公式10.9)。从t-分布表，可以得到t≥8.24的概率小于0.0001。这意味着，仅仅由于偶然而出现观测到的或更强的样本关系几乎不可能。由于p-值很小，我们拒绝认为两变量间无关的零假设。
    * 利用F进行假设检验：基于表10.4，我们再加上三列(表10.5)。表有"均方"(Mean square)的那一列是由每个平方和除以它们相应的自由度得到。由于回归平方和只有一个自由度，所以其均方还是131878.残差均方(RMS)是27182/14=1941.6.然后用回归的均方除以残差的均方就得到F=131878/1941.6=67.90。它有两个自由度，分别是1和14.最后，F≥67.90的概率小于0.0001，所以拒绝零假设。![17](/assets/2014-01-27-statistics/17.png)
6. 使用虚拟变量 
    * 一个`虚拟变量`(dummy variable)是一个只有两个数值的变量，它经常用来表示一个有两类的分类变量。分类变量中，第一类的所有观测都取虚拟变量的一个值，第二类的所有观测都取虚拟变量的另一个值。
    * 自变量是有两个取值的分类变量和因变量是数值变量。在这里，作为自变量的地域有两个取值：东海岸和西海岸。这是一个分类变量。因变量是温度的变化范围，它是一个数值变量。![18](/assets/2014-01-27-statistics/18.png)
    * 因变量是有两个取值的分类变量和自变量是数值变量。在这里，因变量(汽车产地)是一个具有两类的分类变量，自变量(驱动比)是一个数值变量。对这种情形，这些数据的散点图是非线性的，我们不可能拟合一条穿过这些点的直线，因为散点图中所有的点都落在两条水平的直线上。一条是y=0另一条是y=1。对于这些数据，我们拟合一条S形的曲线。这种类型的分析称作`逻辑回归`(logistic regression)。这条曲线从图的右上角的点开始沿这些点，然后很快的下降到图左下角的那些点。这条曲线比任何一条通过这些点的直线的残差都小。![19](/assets/2014-01-27-statistics/19.png)
7. 公式
    * 有两个变量x和y的n个观测数据可以用下面的符号表示：![20](/assets/2014-01-27-statistics/20.png)
    * 相关系数和回归系数(斜率)
        * 相关系数r=`\(\frac{\sum{(x_i-\bar{x})(y_i-\bar{y})}}{\sqrt{\sum{(x_i-\bar{x})^2}\sum{(y_i-\bar{y})^2}}}\)`=`\(\frac{n\sum{x_iy_i}-\sum{x_i}\sum{y_i}}{\sqrt{[n\sum{x_i^2}-(\sum{x_i})^2][n\sum{y_i^2}-(\sum{y_i})^2]}}\)`(10.1)
        * 回归直线的斜率b=`\(\frac{\sum{(x_i-\bar{x})(y_i-\bar{y})}}{\sum{(x_i-\bar{x})^2}}\)`=`\(\frac{n\sum{x_iy_i-\sum{x_i}\sum{y_i}}}{n\sum{x_i^2-(\sum{x_i})^2}}\)`(10.2)
        * r和b有关系：b=`\(r\frac{s_y}{s_x}\)`(10.3)，这里，两个s是两个变量x和y的标准差。
    * 截距
        * 回归直线的截距a：a=`\(\bar{y}-b\bar{x}\)`(10.4)
        * 作为回归分析的一个例子：![21](/assets/2014-01-27-statistics/21.png)
            * `\(b=\frac{4*46-10*16}{4*30-{10}^2}=1.20\)`
            * `\(a=\frac{16}{4}-1.20\frac{10}{4}=1.0\)`
            * `\(r=\frac{4*46-10*16}{\sqrt{(4*30-{10}^2)(4*74-{16}^2)}}=0.85\)`
    * 平方和
        * 总平方和(TSS)=`\(\sum{(y_i-\bar{y})^2}\)`
        * 回归平方和(RegrSS)=`\(\sum{(a+bx_i-\bar{y})^2}\)`(10.5)
        * 残差平方和(RSS)=`\(\sum{(y_i-a-bx_i)^2}\)`
        * `\(r^2=\frac{RegrSS}{TSS}\)`(10.6)
    * 总体的回归系数`\(\beta\)`的置信区间
        * `\(\beta\)`的置信区间：`\(b-t^*s_b\)`到`\(b+t^*s_b\)`(10.7)
        * 这里b是观测的回归系数，`\(t^*\)`是从一个t分布表得到的自由度为n-2的t统计量的1-a/2分为点的值，`\(s_b\)`是b的标准误差，`\(s_b=\sqrt{\frac{RSS/(n-2)}{\sum{(x_i-\bar{x})^2}}}\)`
    * 假设检验
        * 对于我们的脂肪含量和热量的例子，由回归系数b的值得到：`\(t=\frac{b}{s_b}=\frac{15.3}{1.85}=8.24\)`(10.8)
        * 也可由相关系数r出发由下面公式得到相同的t值：`\(t=\frac{r}{\sqrt{\frac{1-r^2}{n-2}}}=\frac{0.910}{\sqrt{\frac{1-0.829}{16-2}}}=8.24\)`(10.9)

##11 ANOVA:一个分类变量和一个数量变量的方差分析
1. `方差分析`(analysis of variance)，简称anova，是用来对比因变量在不同组中的平均值的统计方法。
2. 问题1.犯罪率和地区之间的关系
    * 1986年48个州的暴力犯罪率：![22](/assets/2014-01-27-statistics/22.png)![22-1](/assets/2014-01-27-statistics/22-1.png)
    * 暴力犯罪率的散点图：![23](/assets/2014-01-27-statistics/23.png)
3. 问题2.关系有多强
    * 暴力犯罪率的散点图及总均值和地区均值：![24](/assets/2014-01-27-statistics/24.png)
    * 地区变量：求自`变量平方和`(这里是地区)的公式为：`\((组均值-总均值)^2之和\)`。这里是对所有观测求和。
    * 残差变量：有时称为`误差变量`(error variable)或“所有其它”变量，它是为除自变量之外所有能够对因变量产生影响的变量所起的名字。`残差平方和`定义为，对所有观测的`\((观测-组的均值)^2之和\)`。
    * 地区变量和残差变量的总效应：`总平方和`，公式为对所有观测的：`\((观测-总均值)^2之和\)`。
    * 测量关系的强度：表11.2给出了用平方和来度量的变量的效应。地区变量的效应所占的比例是662641/2804254=0.24，或占24%的总效应。这个比例0.24称为`\(R^2\)`。(这个数可以与回归分析中相关系数的平方直接进行比较)![25](/assets/2014-01-27-statistics/25.png)
    * 我们可以说地区变量与暴力犯罪率变化的24%`有关联`(associated)，而残差变量与剩下的76%有关联。
4. 问题3.这个关系是纯属偶然吗？
    * 零假设：在暴力犯罪率的问题中零假设描述的是7个地区的犯罪率相等，即`\(H_0:\mu_1=\mu_2=\mu_3=\mu_4=\mu_5=\mu_6=\mu_7\)`
    * F变量的p-值：把`\(R^2\)`的值转换成相应的F-值之后(公式11.5)，查F-分布表来找到p-值。
        * `方差分析表`提供了包括用来计算R和F-值的数据。用自由度对自变量和残差变量的效应先做一个调整然后再进行对比就可以得到F的值了。通常方差分析还包括F的p-值。表11.4(公式11.3)列出结果。![26](/assets/2014-01-27-statistics/26.png)
        * F的值就是为了比较自变量和残差变量的效应。在计算中我们对比的不是平方和而是平方和除以它们各自的自由度以得到每个自由度上的平方和(公式11.4)。这个量称为`均方`(mean square)，之所以这样是因为它代表的是效应在自由度上的平均。
        * 用自变量的均方除以残差变量的均方，得到F值为2.11(自由度为6和41的F变量的观测值)。F≥2.11的概率是0.072.也就是说，在两个变量之间没有关系的前提下随机抽样1000次，其中有大约72次的F值因为偶然因素而大于等于2.11。因此在7组48个观测的情况下得到`\(R^2\)`大于等于0.24的概率是边缘统计显著的。
5. 配对分析
    * 如果在同一个实验单元上进行重复测量，就会得到在每个单元中有两个观测值的数据。而处理这类数据时所用的分析方法叫做`配对分析`。
    * 表11.6提供了48个大洲爆率犯罪率的配对数据。它是由已经在表1.1中给出的1986年数据和1992年数据组成。![27](/assets/2014-01-27-statistics/27.png)![28](/assets/2014-01-27-statistics/28.png)
    * 为了找出两个时间点上的数据是否有区别，我们求平均。差异的均值等于119；这说明暴力犯罪率还是有一些变化的。为判断这一变换是否只是偶然因素引起的，我们建立零假设：差异的总均值是0。我们利用第7章中提到的检验单个均值的t-检验。对于该数据，t值是8.74自由度为47，与之相应的p-值小于0.0001，现在我们有了拒绝零假设的一个有力证据(公式11.6)。
    * 与t检验不同，`符号检验`主要考虑的不是两次观测时数值改变了多少而是数值变化的趋势：如果实际上两次观测中数值没有什么变化，则它们的差值就只是在随机变化，没有规律。在我们的例子中48个差值中，只有4个负数，而正数有44个之多。我们利用二项分布来检验“差为正的概率是0.5”的零假设。二项分布表中不包括48个观测值那么多情况，我们通过计算z来得到p-值。这里z=6.21，得到p-值小于0.0001。因此我们拒绝犯罪率没有变化的零假设。
6. 公式    
    * 方差分析：假设数据按表11.7的形式排列——每一组(类)观测值占一列。![29](/assets/2014-01-27-statistics/29.png)
        * 分类自变量的平方和=`\(\sum{n_i(\bar{y_i}-\bar{y})^2}\)`(11.1)
        * 残差平方和=`\(\sum\sum{(\bar{y_{ij}}-\bar{y_i})^2}\)`
        * 总平方和=`\(\sum{\sum{(\bar{y_{ij}}-\bar{y})^2}}\)`
        * `\(R^2=\frac{分类型自变量的平方和}{总平方和}\)`(11.2)
        * 公式中的k是组数(自变量的值的个数)，n是数据中的总观测数：![30](/assets/2014-01-27-statistics/30.png)
        * 平方和的自由度(11.3)
            * 分类变量的自由度=k-1
            * 残差的自由度=n-k
            * 总自由度=n-1
        * 分类变量的均方=`\(\frac{分类变量的平方和}{k-1}\)`(11.4)
        * 残差的均方=`\(\frac{残差平方和}{n-k}\)`
        * F=`\(\frac{分类变量的均方}{残差的均方}\)`(11.5)，其中F-比的自由度是k-1和n-k
    * 配对数据：先从第i个观测单元中计算两次观测的差`\(d_i=y_{Bi}-y{Ai}\)`
        * 其中`\(y_{Bi}\)`是第一次的观测值(起始)，`\(y_{Ai}\)`是第二次的观测值(结束)。然后求`\(d_i\)`的均值`\(\bar{d}\)`以及标准差s，最后转成t-变量：`\(t=\frac{\bar{d}}{s/\sqrt{n}}\)`,n-1 d.f. (11.6)
        * 在前面的例子中上式为：`\(t=\frac{118.47}{93.93/\sqrt{48}}=8.74\)`,47 d.f.

##12 两个顺序变量的秩方法
1. `顺序变量`(rank variable)，也称`次序变量`(ordinal variable)是以数量(或多或少)术语来比较个体的某些特征的变量。例如，选民可能对选举的结果非常感兴趣、有点兴趣或不感兴趣。社会地位可以被分为上层阶级、中产阶级和下层阶级。对于这些顺序变量，我们用`词`(word)来表示变量的值。另外一类顺序变量，如官员年收入从1到10进行排序，10是最高的。这类顺序变量，我们用`数`(number)来代表变量的值。
2. 用词作为值的两个顺序变量。政党身份和对1956年总统选举的兴趣：![31](/assets/2014-01-27-statistics/31.png)
    * 问题1.身份与兴趣间的关系？![32](/assets/2014-01-27-statistics/32.png)
    * 问题2.相关的程度？`系数r`度量了两个取值为词的顺序变量的相关程度。对于选举的数据，得出r=0.21(公式12.1)，表明两变量间有一个比较弱的正相关性。
    * 问题3.总体的关系？零假设假定在总体中两变量间没有关系，而且如果p-值很小就拒绝它。计算p-值需要将观测到的r值转化为一个标准正态的z-变量的值。得到z=6.47，p-值小于0.0001。p-值这样小，所以我们有足够的证据拒绝零假设。
3. 用数作为值的两个顺序变量。1987和1992赛季后国家东部联盟球队的排名。![33](/assets/2014-01-27-statistics/33.png)
    * 问题1.球队的排名与时间的关系？![34](/assets/2014-01-27-statistics/34.png)
    * 问题2.关系强度？为了纪念它的首创者英国心理和统计学家Charles Spearman，`秩顺序相关系数`(rank order correlation coefficient)通常记作`\(r_s\)`，它用来度量取值为数的两个顺序变量的相关程度。也称作Spearman秩相关系数。对于棒球队数据，`\(r_s\)`=-0.09。(公式12.4)
    * 问题3.相关性是由于偶然吗？提出零假设，认为两个变量的关系仅处于偶然。把`\(r_s\)`转化为相应的一个t-变量，自由度为n-2=6-2=4，t=-0.17。r≤-0.09的概率为0.44。这个p-值是不显著的。因此可以说这两个变量的关系仅出于偶然。
4. 公式
    * 系数r。如果我们把一个对选举感兴趣的有政党倾向的人和一个有点兴趣的有较弱政党倾向的人作为一组，我们发现第一个人在两个变量上排名都比第二个人高。在这个表中，第二个人将落在第一个人的左下方。如果所有可能的对都是这种情形，那么r=1.00。如果我们把一个对选举很感兴趣的中立者和一个不怎么感兴趣的有较弱政党倾向的人作为一组，第一个人在政党这个变量上比第二个人低，而在兴趣变量上比第二个人高。在这个表中，第二个人落在第一个人的右下方。如果所有可能的对都是这种情形，那么r=-1.00。![35](/assets/2014-01-27-statistics/35.png)![36](/assets/2014-01-27-statistics/36.png)
        * 要计算有多少对属于第一类，把表12.1中对选举非常感兴趣的262个人和表左下方所有的人配对得到：262(178+273+133+228)=212744对。表中每一个格子中的人都可以和位于他们左下方的人进行配对：`\(相同的次序=\sum{所有的频率与左下方的频率的和的乘积}\)`=262(178+273+133+228)+150(178+133)+237(228+133)+273(133)=394256
        * 要计算有多少对属于第二类，把表12.1中抽取一个各自然后看它右下方的数据：`\(不同的次序=\sum{所有的频率与右下方的频率的和的乘积}\)`=104(273+237+228+125)+150(237+125)+178(228+125)+273(125)=258268
        * `\(r=\frac{相同的次序-不同的次序}{相同的次序+不同的次序}\)`(12.1)
        * 对于这个例子`\(G=\frac{394256-258268}{394256+258268}=0.21\)`
        * 要检验零假设，即对总体的r=0，我们计算`\(z=\frac{G}{\sqrt{\frac{4(行数+1)(列数+1)}{9n(行数-1)(列数-1)}}}\)`(12.2)
        * 这里n是表中观测的总数。对于这个例子：`\(z=\frac{0.21}{\sqrt{\frac{4(3+1)(3+1)}{9(1690)(3-1)(3-1)}}}=6.47\)`
        * 这个z的式子仅是一个近似，对观测很多的比较大的表，这个逼近是很好的。z的更精确的值可由下式计算：`\(z=\frac{G}{\sqrt{1-G^2}}\sqrt{\frac{相同的次序+不同的次序}{n}}\)`=`\(\frac{0.21}{\sqrt{1-{0.21^2}}}\sqrt{\frac{394256+258268}{1690}}=4.22\)`
    * 系数`\(r_s\)`。可以用两列秩代替普通相关系数r的公式(10.1)中的x和y来计算秩顺序相关数。因为两个变量的两列值是从1到n的整数，计算r的公式可以简化为公式12.4
        * 我们有两列顺序(即秩)，现在我们计算每一个观测的两个秩的差异，然后把每个差异平方。这些计算如表12.4所示。从这些平方的和我们用下面公式得到：`\(r_s=1-\frac{6\sum{d_i^2}}{n(n^2-1)}\)`(12.4)
        * 这里，分子中的6是常数，n是秩的对数。![37](/assets/2014-01-27-statistics/37.png)
        * 对于棒球队的数据，基于表12.5计算。![38](/assets/2014-01-27-statistics/38.png)
        * 计算t-检验的统计量：`\(t=\frac{r_s}{\sqrt{1-r_s^2}}\sqrt{n-2}=\frac{-0.09}{\sqrt{1-(-0.09)^2}}\sqrt{6-2}=-0.17\)`,df=4 (12.5)

##13 多元分析
1. `多元统计分析`(multivariable statistical analysis)考察两个或多个自变量对一个因变量的相关的影响。
2. 三种多元分析的方法：![39](/assets/2014-01-27-statistics/39.png)
3. 偏`\(\phi\)`：三个分类型变量。
    * 表13.1显示了一则有关两个分类型变量性别与投票之间的关系的例子。![40](/assets/2014-01-27-statistics/40.png)
    * 两个变量间的关系强度用`\(\phi\)`=0.21衡量。
    * `控制第三个变量`就是在研究两个变量之间的关系时，将数据按照被控制的变量先分成若干子部分，然后在被控制的各个子部分中研究那两个变量之间的关系。所谓按照第三个变量划分子部分意味着让第三变量保持常数。
    * 基于表13.1加入收入这个分类型变量：![41](/assets/2014-01-27-statistics/41.png)
    * 在每个子表中，`\(\phi\)`=0.00，这意味着性别和投票这两个变量之间没有关系。这样，我们可以将数据按收入来分组。
    * `偏\(\phi\)系数`(partial phis coefficient)表明了当一个或多个其它变量被控制时，两个变量之间的关系强度。偏`\(\phi\)`可以认为是每个部分内两个变量之间`\(\phi\)`的平均值，而这些部分是根据控制变量来划分的。当我们控制收入时，偏`\(\phi\)`=0.00也可被称为性别与投票的`各组中的平均\(\phi\)`(average within group `\(\phi\)`)
    * 表13.3显示收入与投票之间的关系；表13.4显示控制性别因素时收入和投票之间的关系：![42](/assets/2014-01-27-statistics/42.png)![43](/assets/2014-01-27-statistics/43.png)
    * 就多元分析而言每个箭头表示了分析中其它变量`在场时`相应变量的`\(\phi\)`。当收入是唯一自变量时，它与投票之间关系的强度是0.45，而当性别因素出现时，这种强度减少到0.40：![44](/assets/2014-01-27-statistics/44.png)
4. 数值型变量的多元回归。
    * `多元回归分析`(multiple regression analysis)是一种用于研究多个数值型自变量与一个数值型因变量之间关系的统计方法。
    * 问题1.数据中的关系是什么？第10章，我们研究了小吃中热量与脂肪含量的关系。在同样的食品中还会发现胆固醇的含量和钠的含量。
    * 问题2.这种关系的形式是什么？
        * 热量=21.3+12.6脂肪-0.11胆固醇+0.18钠
        * 方程中三个系数是`偏回归系数`(partial regression coefficients)。偏回归系数是当我们控制其它所有自变量并使它们保持常值时，某一变量的系数。它是当我们按分析中所有其它自变量的值分组后各个组内回归系数的平均值。
        * 图13.3表明由于脂肪和钠的出现，胆固醇几乎与热量无关：![45](/assets/2014-01-27-statistics/45.png)
        * 上述系数改变的原因是脂肪、胆固醇和钠三个自变量之间互相有关系：
            * 脂肪(fat)与胆固醇(cholesterol)的r=0.69
            * 脂肪(fat)与钠(sodium)的r=0.59
            * 胆固醇(cholesterol)与钠(sodium)的r=0.41
        * 每当我们引入一个与分析中变量有相互关系的变量时，回归系数就发生了改变。没有哪一个变量会保持唯一的系数值；系数会随着我们所用的其它变量而改变。这种现象称为自变量之间的`共线性`(collinearity)。
    * 问题2b.这些关系的强度有多大？
        * 一个`偏相关系数`(partial correlation coefficient)表明了当我们控制其它变量时两个变量之间关系的强度。(公式13.1计算)
    * 问题2c.总体关系的强度有多大？
        * 对于图13.4中的数据，相关系数等于一个相当高的值0.94：![46](/assets/2014-01-27-statistics/46.png)
        * `多重相关系数`(multiple correlation coefficient)R度量因变量的观测值与自变量由回归方程算得的预测值之间的关系强度。R的值域从0到1。
        * 多重相关系数的平方`\(R^2\)`等于0.89，它意味着三个自变量共同解释了热量值差异的89%，残差变量解释了剩下的11%。
    * 问题3.总体中的关系？
        * R的假设检验：零假设“总体中的多重相关系数R为0”，样本得出的R为0.94，由F-变量来计算R的p-值。得出F=31.3，自由度为3和12(公式13.2)。F为31.3或更大的概率为0.000006；故我们拒绝零假设。
        * 每个变量的假设检验：R的值是高度显著的，但它并没有向我们展示是否所有三个自变量均具有统计上的显著效应。
        * 零假设“小吃中脂肪的偏回归系数为12.6，总体数据中相应的系数可以为0吗？”把12.6变为t-变量的一个值，t=4.98，自由度为12，t为12.6或更大值的概率为0.00016。故拒绝零假设。我们也可以去估计这个系数，并得到偏总体回归系数的95%置信区间为7.1到18.1。
        * 类似地，胆固醇的偏回归系数为-0.11，p-值为0.44，p-值如此大，故我们不拒绝没有效应的零假设，总体中相应的系数很可能为0。我们得出热量和胆固醇可能无关的结论。
        * 对钠变量，偏回归系数为0.18的t=2.46.这个t的p-值为0.015，它已经足够小，从而使我们拒绝零假设并得出小吃中热量与钠变量有关的结论。
5. 用一个哑元作多元回归
    * 研究：学院在付给教授薪水上是否存在性别歧视。
    * 薪水与性别的散点图，得出薪水=71.1+5.2性别：![47](/assets/2014-01-27-statistics/47.png)
    * 加入年龄，做多元分析后，得出薪水=40+0.0性别+0.5年龄，下面的几组散点图：![48](/assets/2014-01-27-statistics/48.png)
    * 另一种说明问题的方法是在年龄和薪水的散点图上用不同的记号分别表示男性和女性的散点图，然后在每个组我们用薪水对年龄做回归：![49](/assets/2014-01-27-statistics/49.png)
6. 双因子方差分析
    * `双因子方差分析`(two-way analysis of variance)是有关两个分类型自变量对一个数值型因变量效应的分析。
    * 路线(Main Street/High Street)和时段(高峰/非高峰)是分类型变量，都有两个值。驾驶时间是一个数值型变量，以分钟计算：![50](/assets/2014-01-27-statistics/50.png)
    * 仅对于时段的单因子分析，统计显著的(拒绝零假设)：![51](/assets/2014-01-27-statistics/51.png)
    * 仅对于路线的单因子分析，统计较显著(拒绝零假设)：![52](/assets/2014-01-27-statistics/52.png)
    * 时段和路线的双因子分析：
        * 总平均：驾驶时间均值=20分钟
        * 行效应：高峰时段效应=23分钟-20分钟=3分钟；非高峰时段效应=17分钟-20分钟=-3分钟
        * 列效应：Main Street效应=22分钟-20分钟=2分钟；High Street效应=18分钟-20分钟=-2分钟
        * 由总均值、行效应和列效应计算不同路线和不同时段的平均驾驶时间：![53](/assets/2014-01-27-statistics/53.png)![54](/assets/2014-01-27-statistics/54.png)
        * 残差变量：在该例中，第一次驾驶花了26分钟，而不是均值25分钟，因此残差变量加了一分钟到这次驾驶。残差变量在其它次高峰时段沿Main Street上的驾驶的效应为-0.8，1.5，-0.9和-0.8分钟。![55](/assets/2014-01-27-statistics/55.png)
        * 问题1.数据中是否有任何关系？对每个自变量的分析中可以发现选择哪个时段哪个路线驾驶是有差异的。
        * 问题2.这些关系的强度有多大？
            * 在表13.6中，`\(R^2\)`=0.57,R=0.75表示时段与驾驶时间的关系。类似，从表13.7，`\(R^2\)`=0.25,R=0.50表示路线与驾驶时间的关系。
            * 我们已经得出时间变量的平方和(180.00)与路线变量的平方和(80.00)。这两个变量的联合效应变成180.00+80.00=260.00。这两个自变量解释了驾驶时间差异的260.00/313.98=82%，而残差变量解释了差异中余下的18%。由于`\(R^2\)`=0.82，所有自变量效应的多重相关系数R=0.91。于是，这两个变量合起来与驾驶时间有较强的关系。
            * 总计平方和与两个自变量的联合效应之差为55.98，这是残差变量在双因子分析中的效应。如果我们计算了每个残差并对它们进行平方，这个平方和也等于55.98。双因子分析的残差平方和比任何单因子分析的残差平方和都小，因为残差变量现在不包括两个自变量中的任何一个。![56](/assets/2014-01-27-statistics/56.png)
        * 问题3.这些关系在统计意义上显著吗？对两个变量，`\(R^2\)`=0.82，由此得出F-变量的值为39.48，自由度为2和17。这个F的p-值等于0.0000004，故拒绝零假设。对每个变量分别做的假设显示在表13.10中。跟以前的两个方差分析相比残差平方和少了一个自由度，但净效应仍然是这里的残差均方要比表13.6和13.7中的两个残差均方小。因此，双因子分析中F-值比两个单因子分析中要大。大的F-值产生了更小的p-值。
        * 考虑交互效应。
            * 一年后不同路线和时段的平均驾驶时间：![57](/assets/2014-01-27-statistics/57.png)![58](/assets/2014-01-27-statistics/58.png)
            * 图13.9相比于图13.8，两条线不再平行。现在在高峰时段从Main Street驾驶的联合效应比这两个因素各自效应的和要大。这种附加效应称为`交互效应`(interaction effect)。它发生时，两个变量的联合作用对因变量产生了它们各自效应之和以外的附加效应。
            * 交互效应的平方和等于20.00，交互变量解释了20.00/335.98=6%的驾驶时间差异。这样交互变量与驾驶时间的关系不是很强，R=0.24，表13.12显示所有三个变量的p-值都很小，这意味着它们都与驾驶时间有统计意义上显著的关系：![59](/assets/2014-01-27-statistics/59.png)
7. 公式
    * 偏r(或`\(\phi\)`)
        * 对于三个以`\(x_1,x_2,x_3\)`表示的变量，控制`\(x_3\)`时，`\(x_1,x_2\)`的偏相关系数(用`\(r_{12.3}\)`)：`\(r_{12.3}=\frac{r_{12}-r_{13}r_{23}}{\sqrt{(1-r_{13}^2)(1-r_{23}^2)}}\)`(13.1)
        * 对`\(\phi\)`用同样的公式，只是用`\(\phi\)`代替r。
    * 多重相关系数的F-检验
        * 基于k个自变量和n个观测值，检验总体R为0的零假设：`\(F=\frac{R^2}{1-R^2}\frac{n-k-1}{k}\)`,d.f.=k,n-k-1(13.2)
        * 由算出的F-值用F-分布表算得相应的p-值。
    * 双因子方差分析
        * 表13.13显示了当因变量的数值记号代替时怎样列出双因子方差分析的数据：![60](/assets/2014-01-27-statistics/60.png)
        * 不同的平方和计算(13.3)：
            * 行变量平方和=`\(\sum{n_{i.}(\bar{y_{i.}}-\bar{y})^2}\)`
            * 列变量平方和=`\(\sum{n_{.j}(\bar{y_{j.}}-\bar{y})^2}\)`
            * 交互变量平方和=`\(\sum\sum{n_{ij}(\bar{y_{ij}-\bar{y_{i.}}-\bar{y_{.j}}+\bar{y}})^2}\)`
            * 残差变量平方和=`\(\sum\sum\sum{(y_{ijk}-\bar{y_{ij}})^2}\)`
            * 总平方和=`\(\sum\sum\sum{(y_{ijk}-\bar{y})^2}\)`
        * 对于r行、c列和每个单元内有m个观测值的情形由以下表达式算出自由度(13.4):
            * 行变量自由度=r-1
            * 列变量自由度=c-1
            * 交互变量自由度=(r-1)(c-1)
            * 残差变量自由度=rcm-rc
            * 总自由度=rcm-1
        * 均方由平方和除以相应的自由度算得。F-比率由每个均方除以残差变量均方算得。所有这些数都列在如表13.12的方差分析表中。
